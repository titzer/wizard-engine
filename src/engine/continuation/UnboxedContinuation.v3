// Copyright 2025 Wizard authors. All rights reserved.
// See LICENSE for details of Apache 2.0 license.

type Continuation(stack: WasmStack, version: u64) #unboxed {
	def render(buf: StringBuilder) -> StringBuilder {
		return buf.puts("cont");
	}
}

component Continuations {
	def NULL = Continuation(null, 0);

	def isNull(cont: Continuation) -> bool { return cont.stack == null; }
	def isUsed(cont: Continuation) -> bool { return cont.stack.version != cont.version; }
	def setUsed(cont: Continuation) { cont.stack.version++; }

	def makeContinuation(stack: WasmStack) -> Continuation {
		return Continuation(stack, stack.version);
	}
}
